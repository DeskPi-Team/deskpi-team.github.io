<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://wiki.deskpi.com/super6c/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>DeskPi Super6C - DeskPi Products Wiki</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "DeskPi Super6C";
        var mkdocs_page_input_path = "super6c.md";
        var mkdocs_page_url = "/super6c/";
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> DeskPi Products Wiki
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../rackmate/">DeskPi RackMate T1</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../microcar/">DeskPi MicroCar</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../deskpi_lite_nas_case/">DeskPi Lite NAS Case</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../expansionkit/">DeskPi Lite Expansion Kit</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../deskpi_lite_for_3b/">DeskPi Lite For Raspberry Pi 3B/3B+</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../minipc/">DeskPi Mini PC</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../picomate/">DeskPi PicoMate</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">DeskPi Super6C</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#purchase">Purchase</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#description">Description</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#compatibility">Compatibility</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#featrues">Featrues</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#package-includes">Package Includes:</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#dimension">Dimension</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#applications">Applications</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#software">Software</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#port-definitions">Port definitions</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#power-supply-specifications">Power Supply Specifications</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#mechanical-drawing">Mechanical Drawing</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#block-scheme">Block Scheme</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pin-headers-definitions">Pin Headers definitions</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#how-to-install-cm4-module">How to install CM4 module</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#how-to-flash-image-to-emmc-on-cm4-module">How to Flash image to eMMC on CM4 module.</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#for-more-information-run">For more information run</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#compute-module-4-bootloader">Compute Module 4 Bootloader</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#modifying-the-bootloader-configuration">Modifying the bootloader configuration</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flashing-the-bootloader-eeprom-compute-module-4">Flashing the bootloader EEPROM - Compute Module 4</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#troubleshooting">Troubleshooting</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#how-to-build-your-own-cluster-and-manage-the-cluster-via-ansible">How to build your own cluster and manage the cluster via Ansible</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#fit-for-cm4-lite-version">Fit for CM4 Lite version</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#steps">Steps:</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#ansible-project-configuration">Ansible Project Configuration</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#faq">FAQ</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../itxcase/">DeskPi ITX Case Kit for Super6C</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../deskpilite/">DeskPi Lite</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../deskpinano/">DeskPi Nano</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../deskpipro/">DeskPi Pro</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">DeskPi Products Wiki</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>DeskPi Super6C</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="deskpi-super6c">DeskPi Super6C</h1>
<p><img alt="super6c" src="../imgs/super6c/super6c-main.jpg" /></p>
<h2 id="purchase">Purchase</h2>
<p><img alt="chart" src="../imgs/picomate/shoppingchart.jpg" /> 
<a href="https://deskpi.com/collections/deskpi-super6c">DeskPi Super6C</a></p>
<h2 id="description">Description</h2>
<p>DeskPi Super6C is the Raspberry Pi cluster board a standard size mini-ITX board to be put in a case with up to 6 RPI CM4 Compute Modules.
- For every CM4:
  * M.2 2280 slot (PCIe Gen 2 x1)
  * TF Card slot
  * 5V FAN Header
  * Micro USB 2.0</p>
<ul>
<li>Only for 1st CM4:</li>
<li>USB Host A 2.0 x2</li>
<li>USB Host 2.54 4-pins x2</li>
<li>HDMI 2.0 x1</li>
<li>HDMI 1.4a x1</li>
</ul>
<h2 id="compatibility">Compatibility</h2>
<p>Currently, after testing, Super6C is not only able to support the Raspberry Pi CM4 module but can also boot some CM4 modules from other brands. However, it is limited to just booting, and many core functions of Super6C are still unusable. This is likely due to the pin distribution and functionality of the board-to-board connector being different from that of the Raspberry Pi. It is recommended to continue using the Raspberry Pi CM4 module in conjunction with Super6C.</p>
<ul>
<li>Testing Result on BPi-CM4 V1.0</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align: center;">BananaPi CM4 (BPi-CM4 V1.0)</th>
<th style="text-align: center;">Super6C functons</th>
<th style="text-align: center;">Compatibility</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">USB Port 1</td>
<td style="text-align: center;"><font color=green> YES </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">USB Port 2</td>
<td style="text-align: center;"><font color=green> YES </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">HDMI1</td>
<td style="text-align: center;"><font color=green> YES </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">HDMI2</td>
<td style="text-align: center;"><font color=red> NO </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">ETH1</td>
<td style="text-align: center;"><font color=red> NO </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">ETH2</td>
<td style="text-align: center;"><font color=red> NO </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">Front USB Ports</td>
<td style="text-align: center;"><font color=red> NO </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">M.2 NVMe SSD</td>
<td style="text-align: center;"><font color=red> NO </font></td>
</tr>
</tbody>
</table>
<ul>
<li>Testing Result on Orange Pi OPi-CM4 V1.4</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align: center;">OrangePi CM4 (OPi-CM4 V1.4)</th>
<th style="text-align: center;">Super6C functons</th>
<th style="text-align: center;">Compatibility</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">USB Port 1</td>
<td style="text-align: center;"><font color=red> NO </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">USB Port 2</td>
<td style="text-align: center;"><font color=red> NO </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">HDMI1</td>
<td style="text-align: center;"><font color=green> YES </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">HDMI2</td>
<td style="text-align: center;"><font color=red> NO </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">ETH1</td>
<td style="text-align: center;"><font color=red> NO </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">ETH2</td>
<td style="text-align: center;"><font color=red> NO </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">Front USB Ports</td>
<td style="text-align: center;"><font color=red> NO </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">M.2 NVMe SSD</td>
<td style="text-align: center;"><font color=red> NO </font></td>
</tr>
</tbody>
</table>
<ul>
<li>Testing Result on Orange Pi OPi-CM5 V1.1</li>
</ul>
<blockquote>
<p>Can not booting from Orange Pi OPi-CM5 V1.1 computer module. </p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align: center;">OrangePi CM5 (OPi-CM5 V1.1)</th>
<th style="text-align: center;">Super6C functons</th>
<th style="text-align: center;">Compatibility</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">USB Port 1</td>
<td style="text-align: center;"><font color=red> NO </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">USB Port 2</td>
<td style="text-align: center;"><font color=red> NO </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">HDMI1</td>
<td style="text-align: center;"><font color=red> NO </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">HDMI2</td>
<td style="text-align: center;"><font color=red> NO </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">ETH1</td>
<td style="text-align: center;"><font color=red> NO </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">ETH2</td>
<td style="text-align: center;"><font color=red> NO </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">Front USB Ports</td>
<td style="text-align: center;"><font color=red> NO </font></td>
</tr>
<tr>
<td style="text-align: center;">-</td>
<td style="text-align: center;">M.2 NVMe SSD</td>
<td style="text-align: center;"><font color=red> NO </font></td>
</tr>
</tbody>
</table>
<h2 id="featrues">Featrues</h2>
<h2 id="package-includes">Package Includes:</h2>
<ul>
<li>1pcs Raspberry Pi CM4 Cluster Mini-ITX board.</li>
<li>1pcs 100W Power supply.</li>
</ul>
<blockquote>
<p>Note:  Raspberry Pi CM4 board are not included</p>
</blockquote>
<h2 id="dimension">Dimension</h2>
<p>170mm x 170mm x 21mm (Mini-ITX)</p>
<h2 id="applications">Applications</h2>
<ul>
<li>Self-hosted: Host cloud applications locally or at the edge Learning</li>
<li>Learning: Kubernetes, Docker, Serverless </li>
<li>Development: Build cloud-native and CI/CD for ARM edge infrastructure </li>
<li>Network-Attached Storage or Distributed Storage System :6 x ARM NAS node or CEPH node</li>
</ul>
<h2 id="software">Software</h2>
<p><img alt="software" src="../imgs/super6c/software.png" /></p>
<h2 id="port-definitions">Port definitions</h2>
<p><img alt="PortDefinitions" src="../imgs/super6c/portdefinitions.png" /></p>
<ul>
<li>1 x DC IN +12~24V</li>
<li>2 x RJ45 Gigabit Ethernet Port 1Gbps</li>
<li>2 x Full-Sized HDMI Ports</li>
<li>1 x Micro USB Port from CM4 1# (Flashing EEPROM)</li>
<li>2 x CM4 1# USB Host 2.0 </li>
<li>6 x CM4 Activity LED </li>
<li>3 x Fan Pin Header</li>
<li>1 x Always ON switch </li>
</ul>
<h2 id="power-supply-specifications">Power Supply Specifications</h2>
<ul>
<li>Recommended:
SWITCHING ADAPTER
Model: FJ-SW2025G1904730
INPUT: 100-240V~50/60Hz 2.0A Max
OUTPUT：19.0V ≈ 4.73A， 89.87W</li>
</ul>
<p><img alt="powersupplyport" src="../imgs/super6c/powersupply.png" /></p>
<ul>
<li>
<p>NOTE: <code>Please pay attention</code> to the order of starting up, if the order is wrong, you may see sparks at the DC port, so pay special attention here! ! !</p>
</li>
<li>
<p>Insert the DC head of the power adapter into the DC interface of the Super6C motherboard.</p>
</li>
<li>
<p>Then insert the plug of the power supply into the wall socket or Power cord</p>
</li>
</ul>
<h2 id="mechanical-drawing">Mechanical Drawing</h2>
<p><img alt="Mechanical" src="../imgs/super6c/machinical.png" /></p>
<p><img alt="Mechanical2" src="../imgs/super6c/machinical2.png" /></p>
<h2 id="block-scheme">Block Scheme</h2>
<p><img alt="BlockScheme" src="../imgs/super6c/block_sch.jpg" /></p>
<h2 id="pin-headers-definitions">Pin Headers definitions</h2>
<ul>
<li>CM4 Jumpers Functions</li>
</ul>
<p><img alt="CM4Jumpers" src="../imgs/super6c/cm4jumpers.png" /></p>
<ul>
<li>LED definitions</li>
</ul>
<p><img alt="LED" src="../imgs/super6c/led.png" /></p>
<ul>
<li>4-Pin ATX Power Pins definitions</li>
</ul>
<p>12V Pin and GND:
<img alt="ATX" src="../imgs/super6c/atx.png" /></p>
<p>Power button and Reset Button
<img alt="ATX2" src="../imgs/super6c/atx2.png" /></p>
<p>Distribution of Pins </p>
<p><img alt="ATX3" src="../imgs/super6c/atx3.png" /></p>
<p><strong><em>Note：</em></strong></p>
<ul>
<li>J6: If you are using 9pin USB pins, it is more common for motherboards that support Pentium4 or athlon XP chipsets (such as i845D, i845E, SiS 650, etc.) to need to drop the pins.</li>
</ul>
<p><img alt="J6Pin" src="../imgs/super6c/J6.png" /></p>
<p>If a 10-pin type USB pin is used, such as i815, i815E, i815EP, KT133 and other chipset motherboards, this pin can be reserved, please refer to the motherboard manual for wiring.</p>
<ul>
<li>
<p><code>J27</code>: J27 Pin is the control programming interface for power management, which is directly used for internal production, <code>DO NOT CONNECT!!!</code></p>
</li>
<li>
<p><code>J11/J13</code>: PoE1/PoE2 Not available,<code>DO NOT CONNECT!!!</code></p>
</li>
</ul>
<h2 id="how-to-install-cm4-module">How to install CM4 module</h2>
<p>Please press the CM4 module onto Super6c mainboard as following picture.<br />
Attach the CM4 to the board by simply aligning it with the two connectors on the IO board, then give it a good squeeze. It’ll crunch into place and you should be set.</p>
<p><img alt="cm4install" src="../imgs/super6c/cm4install.jpg" /></p>
<p>and if you have SSD drive, install it as following picture.</p>
<p><img alt="cm4install2" src="../imgs/super6c/cm4install2.jpg" /></p>
<h2 id="how-to-flash-image-to-emmc-on-cm4-module">How to Flash image to eMMC on CM4 module.</h2>
<ul>
<li>Flashing the Compute Module eMMC
The Compute Module has an on-board eMMC device connected to the primary SD card interface. This guide explains how to write data to the eMMC storage using a Compute Module IO board.</li>
</ul>
<p>Please also read the section in the <a href="https://www.raspberrypi.com/documentation/computers/compute-module.html#datasheets-and-schematics">Compute Module Datasheets</a></p>
<ul>
<li>Compute Module 4
Ensure the Compute Module is fitted correctly installed on the IO board. It should lie flat on the IO board.</li>
</ul>
<p>Make sure that <code>nRPBOOT</code> which is on <code>J2</code> (disable eMMC Boot) on the board jumper is fitted</p>
<p>Use a micro USB cable to connect the micro USB slave port MCRO_USB on board to the host device.</p>
<p><strong><em>Do not power up yet.</em></strong></p>
<ul>
<li>
<p>For Windows Users
Under Windows, an installer is available to install the required drivers and boot tool automatically. Alternatively, a user can compile and run it using Cygwin and/or install the drivers manually.</p>
</li>
<li>
<p>Windows Installer
For those who just want to enable the Compute Module eMMC as a mass storage device under Windows, the stand-alone installer is the recommended option. This installer has been tested on Windows 10 32-bit and 64-bit, and Windows XP 32-bit.</p>
</li>
</ul>
<p>Please ensure you are not writing to any USB devices whilst the installer is running.</p>
<p>Download and run the Windows installer to install the drivers and boot tool.</p>
<p><a href="https://github.com/raspberrypi/usbboot/raw/master/win32/rpiboot_setup.exe">windows installer download URL</a></p>
<p>Plug your host PC USB into the USB SLAVE port, making sure you have setup the board as described above.</p>
<p>Apply power to the board; Windows should now find the hardware and install the driver.</p>
<p>Once the driver installation is complete, run the <code>RPiBoot.exe</code> tool that was previously installed.</p>
<p>After a few seconds, the Compute Module eMMC will pop up under Windows as a disk (USB mass storage device).</p>
<p>Building rpiboot on your host system (Cygwin/Linux)
We will be using Git to get the rpiboot source code, so ensure Git is installed. In Cygwin, use the Cygwin installer. On a Raspberry Pi or other Debian-based Linux machine, use the following command:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>git<span class="w"> </span>
</span></code></pre></div>
<p>Git may produce an error if the date is not set correctly. On a Raspberry Pi, enter the following to correct this:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>sudo<span class="w"> </span>data<span class="w"> </span>MMDDhhmm
</span></code></pre></div>
<p>where MM is the month, DD is the date, and hh and mm are hours and minutes respectively.</p>
<ul>
<li>Clone the usbboot tool repository:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>git<span class="w"> </span>clone<span class="w"> </span>--depth<span class="o">=</span><span class="m">1</span><span class="w"> </span>https://github.com/raspberrypi/usbboot
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="nb">cd</span><span class="w"> </span>usbboot
</span></code></pre></div></li>
</ul>
<p>libusb must be installed. If you are using Cygwin, please make sure libusb is installed as previously described. On Raspberry Pi OS or other Debian-based Linux, enter the following command:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libusb-1.0-0-dev<span class="w"> </span>
</span></code></pre></div>
<p>Now build and install the usbboot tool:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>make<span class="w"> </span>
</span></code></pre></div>
<p>Run the usbboot tool and it will wait for a connection:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>sudo<span class="w"> </span>./rpiboot
</span></code></pre></div></p>
<p>Now plug the host machine into the Super6C USB slave port and power on. The rpiboot tool will discover the Compute Module and send boot code to allow access to the eMMC.</p>
<h2 id="for-more-information-run">For more information run</h2>
<ul>
<li>Writing to the eMMC (Windows)
After rpiboot completes, a new USB mass storage drive will appear in Windows. We recommend using Raspberry Pi Imager to write images to the drive.</li>
</ul>
<p>Make sure <code>J2 (nRPBOOT)</code> is set to the disabled position and/or nothing is plugged into the USB slave port. Power cycling the IO board should now result in the Compute Module booting from eMMC.</p>
<ul>
<li>Writing to the eMMC (Linux)
After rpiboot completes, you will see a new device appear; this is commonly /dev/sda on a Raspberry Pi but it could be another location such as /dev/sdb, so check in /dev/ or run lsblk before running rpiboot so you can see what changes.</li>
</ul>
<p>You now need to write a raw OS image (such as Raspberry Pi OS) to the device. Note the following command may take some time to complete, depending on the size of the image: (Change /dev/sdX to the appropriate device.)</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>sudo<span class="w"> </span>dd<span class="w"> </span><span class="k">if</span><span class="o">=</span>raw_os_image_of_your_choice.img<span class="w"> </span><span class="nv">of</span><span class="o">=</span>/dev/sdX<span class="w"> </span><span class="nv">bs</span><span class="o">=</span>4MiB
</span></code></pre></div>
<p>Once the image has been written, unplug and re-plug the USB; you should see two partitions appear (for Raspberry Pi OS) in /dev. In total, you should see something similar to this:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>/dev/sdX<span class="w">  </span>&lt;-<span class="w"> </span>device
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>/dev/sdX1<span class="w"> </span>&lt;-<span class="w"> </span>First<span class="w"> </span>partition<span class="w"> </span><span class="o">(</span>FAT<span class="o">)</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>/dev/sdX2<span class="w"> </span>&lt;-<span class="w"> </span>Second<span class="w"> </span>partition<span class="w"> </span><span class="o">(</span>Linux<span class="w"> </span>Filesystem<span class="o">)</span>
</span></code></pre></div>
<p>The /dev/sdX1 and /dev/sdX2 partitions can now be mounted normally.</p>
<p>Make sure <code>J2 (nRPBOOT)</code> is set to the disabled position and/or nothing is plugged into the USB slave port. Power cycling the board should now result in the Compute Module booting from eMMC.
<img alt="nRPBOOTJumper" src="../imgs/super6c/jumberj2.png" /></p>
<h2 id="compute-module-4-bootloader">Compute Module 4 Bootloader</h2>
<p>The default bootloader configuration on CM4 is designed to support bring up and development on a Compute Module 4 IO board and the software version flashed at manufacture may be older than the latest release. For final products please consider:</p>
<ul>
<li>
<p>Selecting and verifying a specific bootloader release. The version in the usbboot repo is always a recent stable release.</p>
</li>
<li>
<p>Configuring the boot device (e.g. network boot). See BOOT_ORDER section in the bootloader configuration guide.</p>
</li>
<li>
<p>Enabling hardware write protection on the bootloader EEPROM to ensure that the bootloader can’t be modified on remote/inaccessible products.</p>
</li>
</ul>
<p>N.B. The Compute Module 4 ROM never runs recovery.bin from SD/EMMC and the rpi-eeprom-update service is not enabled by default. This is necessary because the EMMC is not removable and an invalid recovery.bin file would prevent the system from booting. This can be overridden and used with self-update mode where the bootloader can be updated from USB MSD or Network boot. However, self-update mode is not an atomic update and therefore not safe in the event of a power failure whilst the EEPROM was being updated.</p>
<h2 id="modifying-the-bootloader-configuration">Modifying the bootloader configuration</h2>
<p>To modify the CM4 bootloader configuration:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nb">cd</span><span class="w"> </span>usbboot/recovery
</span></code></pre></div></p>
<p>Replace pieeprom.original.bin if a specific bootloader release is required.</p>
<p>Edit the default boot.conf bootloader configuration file. Typically, at least the BOOT_ORDER must be updated: </p>
<ul>
<li>
<p>For network boot <code>BOOT_ORDER=0xf2</code></p>
</li>
<li>
<p>For SD/EMMC boot <code>BOOT_ORDER=0xf1</code></p>
</li>
<li>
<p>For USB boot failing over to EMMC <code>BOOT_ORDER=0xf15</code></p>
</li>
</ul>
<p>Run <code>./update-pieeprom.sh</code> to update the EEPROM image <code>pieeprom.bin</code> image file.</p>
<p>If EEPROM write protection is required then edit config.txt and add <code>eeprom_write_protect=1</code>. Hardware write-protection must be enabled via software and then locked by pulling the EEPROM_nWP pin low.</p>
<p>Run <code>../rpiboot -d</code>. to update the bootloader using the updated EEPROM image pieeprom.bin</p>
<p>The pieeprom.bin file is now ready to be flashed to the Compute Module 4.</p>
<h2 id="flashing-the-bootloader-eeprom-compute-module-4">Flashing the bootloader EEPROM - Compute Module 4</h2>
<p>To flash the bootloader EEPROM follow the same hardware setup as for flashing the EMMC but also ensure <code>EEPROM_nWP</code> is NOT pulled low. Once complete EEPROM_nWP may be pulled low again.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># Writes recovery/pieeprom bin to the bootloader EEPROM.</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>./rpiboot<span class="w"> </span>-d<span class="w"> </span>recovery
</span></code></pre></div>
<h2 id="troubleshooting">Troubleshooting</h2>
<p>For a small percentage of Raspberry Pi Compute Module 3s, booting problems have been reported. We have traced these back to the method used to create the FAT32 partition; we believe the problem is due to a difference in timing between the BCM2835/6/7 and the newer eMMC devices. The following method of creating the partition is a reliable solution in our hands.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>sudo<span class="w"> </span>parted<span class="w"> </span>/dev/&lt;device&gt;
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="o">(</span>parted<span class="o">)</span><span class="w"> </span>mkpart<span class="w"> </span>primary<span class="w"> </span>fat32<span class="w"> </span>4MiB<span class="w"> </span>64MiB
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="o">(</span>parted<span class="o">)</span><span class="w"> </span>q
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>sudo<span class="w"> </span>mkfs.vfat<span class="w"> </span>-F32<span class="w"> </span>/dev/&lt;device&gt;
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>sudo<span class="w"> </span>cp<span class="w"> </span>-r<span class="w"> </span>&lt;files&gt;/*<span class="w"> </span>&lt;mountpoint&gt;
</span></code></pre></div>
<p>After Flash Raspberry Pi OS to eMMC on CM4 module, just power off the system, and one complete, 5 to go, just repeat those step five times. </p>
<p>If your CM4 Module does not have eMMC on board, that will be easy, just flash Raspberry Pi OS to TF card or SSD drive, and insert them to card slot, fix it with screws. and connect the power supply, and press <code>PWR_BTN</code> button to power them on.</p>
<p>If your CM4 module has eMMC on board, the SSD drive and TF card can be external mass storage.</p>
<p><img alt="storage" src="../imgs/super6c/cm4install2.jpg" /></p>
<h2 id="how-to-build-your-own-cluster-and-manage-the-cluster-via-ansible">How to build your own cluster and manage the cluster via Ansible</h2>
<h3 id="fit-for-cm4-lite-version">Fit for CM4 Lite version</h3>
<p><strong><em>Note:</em></strong>
The latest Raspberry Pi OS does not contain pi user and it may not need to add <code>dtoverlay=dwc2,dr_mode=host</code> to config.txt file on location <code>/boot</code>.</p>
<blockquote>
<p>Assume you are using the old version (Raspberry Pi OS 2021-11-08)</p>
</blockquote>
<p>CM4 Lite means Raspberry Pi Computer module come without a EMMC storage onboard.　That means additional MicroSD card(TF card) is required.</p>
<h3 id="steps">Steps:</h3>
<ul>
<li>
<p>Download the latest Raspberry Pi OS 64bit image from: 
<a href="https://downloads.raspberrypi.org/raspios_arm64/images/raspios_arm64-2021-11-08/">Download Image</a></p>
</li>
<li>
<p>Unzip it and flash the .img file to TF card by using Etcher tool, which can be downloaded via<a href="https://www.balena.io/etcher/">Download flash tool</a></p>
</li>
<li>
<p>Modify config.txt file in TF card and adding <code>dtoverlay=dwc2,dr_mode=host</code> to it and save it. (Do not need to execute this step if your using the latest version image)</p>
</li>
<li>
<p>Before we unplug, now that your CM4 is fully flashed and ready to go, you’ll be surprised to learn that the USB Ports are disabled by default. Yes, really. Remember, this is a board designed to be embedded elsewhere and not for consumer-level off-the-shelf use.</p>
</li>
<li>
<p>In the “boot” folder, find the config.txt and add the following:</p>
</li>
</ul>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nv">dtoverlay</span><span class="o">=</span>dwc2,dr_mode<span class="o">=</span>host
</span></code></pre></div>
<p>This will turn on the USB ports when you boot up, but if you accidentally keep the micro USB in, you will run into issues. Before you begin your first boot, make sure everything is unplugged. Boot and then plug in your mouse or keyboard.</p>
<p>If you’re like me and couldn’t get a wi-fi version, this is where you’ll plug in your dongle or ethernet cable.</p>
<ul>
<li>
<p>Create a new file named ssh on TF card /boot folder</p>
</li>
<li>
<p>Insert TF card into card slot on Super6C board.</p>
</li>
<li>
<p>Connect the power supply to DC Socket or Using ATX Power supply. (Max. 24V/6.15A)</p>
</li>
<li>
<p>Connect Full-sized HDMI cable to super6C, Other head connect to your TV or Monitor.</p>
</li>
<li>
<p>Connect Keyboard and mouse to USB2.0 port on board.</p>
</li>
<li>
<p>Connect Ethernet cable to ETH1 to your Router.</p>
</li>
<li>
<p>Press <code>PWR_BTN</code> button to booting up all of CM4 modules.</p>
</li>
<li>
<p>Press <code>Reset</code> button will reset all of CM4 modules, unsaved file will be lost!!!</p>
</li>
<li>
<p>Login to Raspberry pi</p>
</li>
</ul>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>username:<span class="w"> </span>pi<span class="w">  </span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>default<span class="w"> </span>password:<span class="w"> </span>raspberry
</span></code></pre></div>
* Make sure your OS can access internet.</p>
<ul>
<li>Deploy ansible environments as following steps</li>
</ul>
<p>If you want to use Ansible to manage Raspberry Pi cluster, you need to upgrade python version from 3.7 to 3.8 as following steps:</p>
<ol>
<li>Remove old version python </li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>remove<span class="w"> </span>ansible<span class="w"> </span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>purge<span class="w"> </span>–y<span class="w"> </span>python2.7-minimal
</span></code></pre></div>
<ol>
<li>Update and upgrade system.</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>upgrade<span class="w"> </span>–y
</span></code></pre></div>
<ol>
<li>Install dependencies. </li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>build-essential<span class="w"> </span>tk-dev<span class="w"> </span>libncurses5-dev<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>libncursesw5-dev<span class="w"> </span>libreadline6-dev<span class="w"> </span>libdb5.3-dev<span class="w"> </span>libgdbm-dev<span class="w"> </span>libsqlite3-dev<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>libssl-dev<span class="w"> </span>libbz2-dev<span class="w"> </span>libexpat1-dev<span class="w"> </span>liblzma-dev<span class="w"> </span>zlib1g-dev<span class="w"> </span>libffi-dev
</span></code></pre></div>
<ol>
<li>Download source code and compile it.</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="nv">version</span><span class="o">=</span><span class="m">3</span>.8.5
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>wget<span class="w"> </span>https://www.python.org/ftp/python/<span class="nv">$version</span>/Python-<span class="nv">$version</span>.tgz
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>tar<span class="w"> </span>zxf<span class="w"> </span>Python-<span class="nv">$version</span>.tgz
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="nb">cd</span><span class="w"> </span>Python-<span class="nv">$version</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>./configure<span class="w"> </span>--enable-optimizations
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>make<span class="w"> </span>-j4
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>sudo<span class="w"> </span>make<span class="w"> </span>altinstall
</span></code></pre></div>
<blockquote>
<p>Do remember:　Installs Python into /usr/local/bin</p>
</blockquote>
<ol>
<li>Install ansible </li>
</ol>
<p>We can use apt or your particular distro package manager, but doing that, we risk no getting the latest version available.
In some cases, I have to agree that is good idea, we make sure system is kept stable and the packages has been tested enough, but in technologies like Ansible, which is still changing so rapidly, I recommend you to go ahead in your tests and get the latest version, that way you will also learn to use those latest versions, which have some modules usage differences.
Lets see the version installed using apt in Raspbian.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>list<span class="w"> </span>ansible
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>pip3<span class="w"> </span>install<span class="w"> </span>ansible<span class="w"> </span>--user
</span></code></pre></div>
<p>Installing Ansible using the --user option, will make that the binary will be available directly under your user home, and not in your root bin directory (/bin,/usr/bin..)</p>
<p><img alt="pathvar" src="../imgs/super6c/pathenv.png" /></p>
<p>For that, I recommend you to add your <code>$user_home/.local/bin</code> to your PATH environment:</p>
<p><img alt="env" src="../imgs/super6c/env.png" /></p>
<h3 id="ansible-project-configuration">Ansible Project Configuration</h3>
<p>Now that we have Ansible installed, let’s set some basic configuration.</p>
<p>Create a directory for our first project where we are going to set the different configuration files and Ansible playbooks
<div class="language-bash highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>mkdir<span class="w"> </span>Ansible
</span></code></pre></div></p>
<p>First file we are going to create, is an Ansible configuration file. This will make sure we are using correct inventory file and some specific options for this project.</p>
<p>In this case, we will use the inventory file in the local directory and will be connecting to the remote server as root. Additionally, will disable ssh-key check so we can connect to the servers without doing first ssh-key handshake (is a security risk, but will help us to destroy and deploy containers and VMs more rapidly in the future)</p>
<p><img alt="sshkey" src="../imgs/super6c/sshkey.png" /></p>
<p>Using --version attribute, will allow us to make sure we are suing correct configuration file:</p>
<p><img alt="version" src="../imgs/super6c/version.png" /></p>
<p>Create the inventory file with the list of hosts </p>
<p><img alt="host" src="../imgs/super6c/host.png" /></p>
<p>We can list all the hosts from our inventory：</p>
<p><img alt="inventory" src="../imgs/super6c/inventory.png" /></p>
<p>If we try the command ansible ping we will have errors, since we can not actually connect to our servers using SSH public keys.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>ansible<span class="w"> </span>all<span class="w"> </span>–m<span class="w"> </span>ping
</span></code></pre></div>
<img alt="ansibleping" src="../imgs/super6c/ansibleping.png" /></p>
<p>and before that, we need to create a file called ping.yml. </p>
<p><img alt="yaml" src="../imgs/super6c/yaml.png" /></p>
<h2 id="faq">FAQ</h2>
<ul>
<li>
<p>Q: What can I do with Super6C ?
  A: Home server (homelab) and cloud apps hosting. Learn Kubernetes, Docker Swarm, Serverless, Microservices on bare metal Cloud-native apps testing environment Learn concepts of distributed Machine Learning apps Prototype and learn cluster applications, parallel computing, and distributed computing concepts Host K8S, K3S, Minecraft, Plex, Owncloud, Nextcloud, Seafile, Minio, Tensorflow</p>
</li>
<li>
<p>Q: Which Raspberry Pi models are compatible ?
  A: Super6C supports all Raspberry Pi CM4 with and without eMMC.</p>
</li>
<li>
<p>Q: Does Raspberry Pi include compute modules ?
  A: No, the product only have cluster motherboard and power adapter.</p>
</li>
<li>
<p>Q: From where Super6C boots OS ?
  A: You can boot the OS either from eMMC, SD Card or netboot.</p>
</li>
<li>
<p>Q: Does each node get its own IP address?
  A: Yes</p>
</li>
<li>
<p>Q: How the compute modelues communicate with each other ?
  A: The nodes interconnected with the onboard 1 Gbps switch. And, each node has 1Gbps speed.</p>
</li>
<li>
<p>Q: Do all the slots need to be filled in ?
  A: The cluster works with any amount of nodes. You can start with a couple of nodes and scale when needed.</p>
</li>
<li>
<p>Q: Can I flash compute modules through the board ?
  A:Yes, you can flash a compute module using a Micro USB cable.</p>
</li>
<li>
<p>Q: How do the NIC, Ethernet, USB, HDMI, and audio ports work ?
  A: There are 2 USB-A an 2 USB 2.54 Pins on the board.They only connect to CM4 1$. The two HDMI ports are also the same. NIC – There is an 8-port gigabit switch on the board. Each port goes to each node plus one uplink. Two RJ45 out are from the switch. You can use them connect to other network device without extern switch.</p>
</li>
<li>
<p>Q: Can Super6C function from either an ATX power supply 12V ?
  A: Yes.</p>
</li>
<li>
<p>Q: Can I use this cluster io expansion board to just running my MySQL server?
  A: Yes, you can running not only MySQL server but also PostgreSQL, SQLite, Mongo DB and so on.</p>
</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../picomate/" class="btn btn-neutral float-left" title="DeskPi PicoMate"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../itxcase/" class="btn btn-neutral float-right" title="DeskPi ITX Case Kit for Super6C">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../picomate/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../itxcase/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
